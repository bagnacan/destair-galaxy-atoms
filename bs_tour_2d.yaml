id: bs_tour_2d
name: 'BS-Seq analysis'
description: 'Quality control and data preprocessing with FastQC and Trim Galore!'
title_default: 'BS-Seq analysis'
steps:
  - title: '<b>Outline</b>'
    element: ''
    content: 'In this tour we will carry out quality control analysis of BS-Seq data.<br />
This represents the first task in analysing raw high throughput sequences,<br />
because it provides an overview of the overall quality of data, as well as<br />
a mean to remove low quality sequence reads that might ultimately bias the<br />
interpretation of results.<br />
Here, we will leverage on two tools: <b>FastQC</b>, to assess the quality of the<br />
provided sequences, and <b>Trim Galore!</b>, to remove low quality reads.<br /><br />
Click <b>Next</b> to start the analysis.<br />'
    backdrop: true

  - title: '<b>Quality control</b>'
    element: '#tool-search-query'
    content: 'Look for the <b>FastQC</b> tool.<br />
FastQC plots the overall quality of the input datasets, providing a<br />
starting point for interpreting NGS data.<br /><br />
Click <b>Next</b> to load it.<br />'
    placement: right
    textinsert: fastqc
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fdevteam%2Ffastqc%2Ffastqc%2F0.72%2Bgalaxy1"]

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="input_file"]'
    content: 'Click on the <b>Dataset collection</b> icon, and select the first<br />
collection.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="input_file"]'
    content: 'For all remaining parametrisation options, we will use the provided<br />
default settings. However, for further information, please refer to the<br />
manual provided below the tool box.<br /><br />
Click <b>Next</b> to execute.<br />'
    placement: bottom
    postclick:
      - '#execute'

  - title: '<b>Quality control</b>'
    element: '#right'
    content: 'FastQC processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Please repeat this operation on the remaining collections.<br /><br />
Click <b>Next</b> to overview your data.<br />'
    placement: left

  - title: '<b>Quality control</b>'
    element: '#right'
    content: 'FastQC generates diverse plots to assess the quality of the input<br />
sequences.<br />
Click on the last <b>Webpage</b> entry in your history, and click the eye icon<br />
of one of the FastQC reports to understand the quality of your data.<br /><br />
Click <b>Next</b> to review the properties of your data.<br />'
    placement: left

  - title: '<b>Quality control</b>'
    element: '#center'
    content: 'Under <b>Summary</b>, click on <b>Basic statistics</b>.<br /><br />
The <b>Basic statistics</b> table provides the summary statistics of the<br />
provided input dataset.<br />
More information on the <b>Basic Statistics</b> can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/1%20Basic%20Statistics.html" target="_blank">here</a>.<br /><br />
Click <b>Next</b> to overview the next plot.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: '#center'
    content: 'Under <b>Summary</b>, click on <b>Per base sequence quality</b>.<br /><br />
The <b>Per base sequence quality</b> plot shows the average quality scores<br />
of all reads of each sequence of the provided input dataset.<br />
The Y axis shows the quality score: the higher, the better the base<br />
call. The background color of the graph divides the base call<br />
operation into:<br />
- Very good quality (green)<br />
- Reasonable quality (orange)<br />
- Poor quality (red).<br />
The quality of each call usually degrades as the sequencing run<br />
progresses. Here however, each provided input dataset shows lower<br />
average quality scores at the beginning of each sequence. Although<br />
these scores still account for reasonable quality reads, a reason<br />
behind this trend might be that the image scanner focus had to be<br />
recalibrated during the first sequence run cycles.<br />
More information on the <b>Per base sequence quality</b> plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/2%20Per%20Base%20Sequence%20Quality.html" target="_blank">here</a>.<br /><br />
Click <b>Next</b> to overview the next plot.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: '#center'
    content: 'Under <b>Summary</b>, click on <b>Per sequence quality scores</b>.<br /><br />
The <b>Per sequence quality scores</b> plot shows if a subset of sequences<br />
have universally low quality values.<br />
If a significant subset of sequences in a run have overall low quality<br />
scores, this suggests that some kind of systematic problem occurred<br />
during the sequencing experiment. Here, the entire sequence set scores<br />
well, showing the desired overall behavior for a sequence set: a peak<br />
(large sequence subset) showing a good score, and a short tail<br />
(sequence subset) scoring lower, although still well.<br />
More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/3%20Per%20Sequence%20Quality%20Scores.html" target="_blank">here</a>.<br /><br />
Click <b>Next</b> to overview the next plot.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: '#center'
    content: 'Under <b>Summary</b>, click on <b>Per base sequence content</b>.<br /><br />
The <b>Per base sequence content</b> plot shows the percentage of occurrence<br />
of each base in each position of each sequence.<br />
The four bases should not be hugely imbalanced. However, some libraries<br />
will always produce biased sequence composition when fragmentation does<br />
not occur randomly. Here, each provided input dataset shows the desired<br />
trend.<br />
More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/4%20Per%20Base%20Sequence%20Content.html" target="_blank">here</a>.<br /><br />
Click <b>Next</b> to overview the next plot.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: '#center'
    content: 'Under <b>Summary</b>, click on <b>Per sequence GC content</b>.<br /><br />
The <b>Per sequence GC content</b> plot shows the GC content distribution of<br />
the provided sample.<br />
This should follow a normal distribution. However, unusually shaped<br />
distribution might occur in case of a contaminated library. A shifted<br />
normal distribution instead indicates some systematic bias,<br />
independent of base position. Here, each provided sample aligns to the<br />
theoretical (blue line) CG distribution.<br />
More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/5%20Per%20Sequence%20GC%20Content.html" target="_blank">here</a>.<br /><br />
Click <b>Next</b> to overview the next plot.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: '#center'
    content: 'Under <b>Summary</b>, click on <b>Per base N content</b>.<br /><br />
The <b>Per base N content</b> plot shows the percentage of Ns occurring within<br />
the provided sequences.<br />
If a sequencer is unable to make a base call with confidence, then it<br />
will place an N, where N represents an ambiguous nucleotide: a base<br />
which could not be correctly identified.<br />
High number of Ns are a sign of low quality sequence reads, which might<br />
be due to transient problems occurring during the sequencing experiment.<br />
Here, each provided sample shows the ideal percentage of N at each<br />
position in the sequence set, accounting for a good sequencing run.<br />
More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/6%20Per%20Base%20N%20Content.html" target="_blank">here</a>.<br /><br />
Click <b>Next</b> to overview the next plot.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: '#center'
    content: 'Under <b>Summary</b>, click on <b>Sequence length distribution</b>.<br /><br />
The <b>Sequence length distribution</b> plot shows the distribution of sequence<br />
read length.<br />
For NGS sequencers generating uniform sequence reads, this will result<br />
in a spike around a fixed length value.<br />
More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/7%20Sequence%20Length%20Distribution.html" target="_blank">here</a>.<br /><br />
Click <b>Next</b> to overview the next plot.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: '#center'
    content: 'Under <b>Summary</b>, click on <b>Sequence duplication levels</b>.<br /><br />
The <b>Sequence duplication levels</b> plot shows the relative number of<br />
sequences with different degrees of duplication. Here, the blue line<br />
represents the full sequence set, showing how its duplication levels<br />
are distributed; the red line instead, represents the de-duplicated<br />
sequences, plotting the proportions of deduplicated sequence sets which<br />
come from different duplication levels in the original data.<br />
More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/8%20Duplicate%20Sequences.html" target="_blank">here</a>.<br /><br />
Click <b>Next</b> to overview the next plot.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: '#center'
    content: 'Under <b>Summary</b>, click on <b>Overrepresented sequences</b>.<br /><br />
The <b>Overrepresented sequences</b> plot shows all sequence making up for more<br />
than 0.1% of the total number of sequences in the dataset.<br />
If a sequence is overrepresented, this means that it is either highly<br />
biologically significant, or that it is contaminant for the current<br />
library. Here, each provided sequence dataset shows no overrepresented<br />
sequences.<br />
More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/9%20Overrepresented%20Sequences.html" target="_blank">here</a>.<br /><br />
Click <b>Next</b> to overview the next plot.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: '#center'
    content: 'Under <b>Summary</b>, click on <b>Adapter content</b>.<br /><br />
The <b>Adapter content</b> plot shows the amount of residual tag sequences<br />
within the sample.<br />
Base frequencies across the reads should follow a uniform distribution,<br />
on the contrary, uneven distributions (high frequencies for certain<br />
bases over several positions) indicate remaining sequence artifacts<br />
within the dataset.<br />
More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/10%20Adapter%20Content.html" target="_blank">here</a>.<br /><br />
Click <b>Next</b> to overview the next plot.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: ''
    content: 'Now that the quality of the input dataset have been assessed, it is<br />
necessary to improve the overall quality of the input reads.<br /><br />
Click <b>Next</b> to start this process.<br />'

  - title: '<b>Quality control</b>'
    element: '#tool-search-query'
    content: 'Look for the <b>Trim Galore!</b> tool.<br />
Trim Galore! is an adapter/sequence trim/removal tool, which searches for
contaminants, adapters, and low quality score reads, and ultimately removes
them to improve the overall quality of the input datasets.<br /><br />
Click <b>Next</b> to load it.<br />'
    placement: right
    textinsert: trim galore
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Ftrim_galore%2Ftrim_galore%2F0.6.3"]

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="singlePaired|sPaired"]'
    content: 'Select <b>Paired-end</b>.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="singlePaired|input_mate1"]'
    content: 'Click on the <b>Dataset collection</b> icon, and select the 1st<br />
collection.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="singlePaired|input_mate2"]'
    content: 'Click on the <b>Dataset collection</b> icon, and select the 2nd<br />
collection.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="params|settingsType"]'
    content: 'Select <b>Full parameter list</b>.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="params|stringency"]'
    content: 'This indicates how many bp are required for the adapter to
overlap with the sequence read to remove the sequence from the dataset.<br />
The default value is too stringent, and on average will result in removing 25%
of the reads.<br />
Change this parameter to 5.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="params|stringency"]'
    content: 'With the current parametrisation, Trim Galore! will:<br />
- Automatically detect the adapter sequences to be trimmed<br />
- Trim low-quality score sequence ends<br />
- Remove sequences whose overlap with adapter sequences is at least 5 bp<br />
- Discard reads whose length became shorter than 20 bp.<br />
For all remaining parametrisation options, we will use the provided default settings. However, for further information, please refer to the manual provided below the tool box.<br /><br />
Click <b>Next</b> to execute.<br />'
    placement: bottom
    postclick:
      - '#execute'

  - title: '<b>Quality control</b>'
    element: '#right'
    content: 'Trim Galore! processing has begun, and the results are loading<br />
in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Please repeat this operation on the remaining collections.<br /><br />
Click <b>Next</b> to overview how the overall quality of your data has<br />
improved.<br />'
    placement: left

  - title: '<b>Quality control</b>'
    element: '#tool-search-query'
    content: 'Look for the <b>FastQC</b> tool.<br />
FastQC is used once again to assess the overall quality of the<br />
<b>processed</b> data: the first run of FastQC assessed the quality of the<br />
provided datasets collection; then, based on the generated plots, the<br />
following trimming operation got rid of all those reads that FastQC<br />
highlighted as potential bias for the analysis (and ultimately the<br />
interpretation of results). Here, FastQC is used to assess the overall<br />
quality of the trimmed data.<br /><br />
Click <b>Next</b> to load it.<br />'
    placement: right
    textinsert: fastqc
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fdevteam%2Ffastqc%2Ffastqc%2F0.72%2Bgalaxy1"]

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="input_file"]'
    content: 'Click on the <b>Dataset collection</b> icon, and select the first trimmed<br />
collection.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="input_file"]'
    content: 'For all remaining parametrisation options, we will use the provided<br />
default settings. However, for further information, please refer to<br />
the manual provided below the tool box.<br /><br />
Click <b>Next</b> to execute.<br />'
    placement: bottom
    postclick:
      - '#execute'

  - title: '<b>Quality control</b>'
    element: '#right'
    content: 'FastQC processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Please repeat this operation on the remaining collections.<br /><br />
Click <b>Next</b> to overview your data.<br />'
    placement: left

  - title: '<b>Quality control</b>'
    element: '#right'
    content: 'FastQC generates diverse plots to assess the quality of the input<br />
sequences.<br />
Click on the last <b>Webpage</b> entry in your history, and click the eye icon<br />
of one of the FastQC reports to understand the quality of your data.<br /><br />
Click <b>Next</b> to review the properties of your data.<br />'
    placement: left

  - title: '<b>Quality control</b>'
    element: ''
    content: 'The quality control and data preprocessing analysis has been completed.<br />'
    placement: center
    backdrop: true
