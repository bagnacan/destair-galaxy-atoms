id: bs_tour_4a
name: 'BS-Seq analysis'
description: 'Alignment of sequence reads against a reference genome using Bismark'
title_default: 'BS-Seq analysis'
steps:
  - title: '<b>Outline</b>'
    element: '#masthead:visible'
    content: 'In this tour we will align MethylC sequenced reads against a reference genome. This represents a necessary task for the quantification of methilated Cytosines in genomic CpG, CHG and CHH contexts which can be later used to infer and evaluate e.g. enhancer promoter or gene body methylation rates.<br>
Here, we will leverage on <b>Bismark</b>.'
    placement: bottom

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#tool-search-query:visible'
    content: 'Search for the <b>Bismark Mapper</b> tool.<br>
Bismark aligns the preprocessed sequences of control samples against the provided reference genome.'
    placement: right
    textinsert: bismark mapper
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Fbismark%2Fbismark_bowtie2%2F0.22.1%2Bgalaxy1"]



# bismark params



  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="refGenomeSource|genomeSource"]:visible'
    placement: bottom
    content: '<h4>Select: <b>Generate Bismark indexes from Genome (fasta) in your Galaxy history</b></h4>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="singlePaired|sPaired"]:visible'
    placement: top
    content: '<h4>Select: <b>Paired-end</b></h4>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="singlePaired|mate_list_0|input_mate1"] .btn-group.ui-radiobutton > :nth-child(3):visible'
    content: 'Select dataset collection.'
    placement: bottom
    onnextclick:
      - '[tour_id="singlePaired|mate_list_0|input_mate1"] .btn-group.ui-radiobutton > :nth-child(3):visible'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="singlePaired|mate_list_0|input_mate1"]:visible'
    placement: top
    content: '<h4>Select: <b>trimmed.ctr.R1</b></h4>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="singlePaired|mate_list_0|input_mate2"] .btn-group.ui-radiobutton > :nth-child(3):visible'
    content: 'Select dataset collection.'
    placement: bottom
    onnextclick:
      - '[tour_id="singlePaired|mate_list_0|input_mate2"] .btn-group.ui-radiobutton > :nth-child(3):visible'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="singlePaired|mate_list_0|input_mate2"]:visible'
    placement: top
    content: '<h4>Select: <b>trimmed.ctr.R2</b></h4>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#execute:visible'
    content: 'For all remaining parametrisation options, we will use the provided default settings.<br>
However, for further information, please refer to the manual provided below the tool box.'
    placement: top
    postclick:
      - '#execute:visible'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#right:visible'
    content: 'Bismark processing has begun, and the results are loading in your history.'
    placement: left
    onloadwait:
      - element: '#current-history-panel .list-items > :nth-child(1) .name:contains("Bismark Mapper")'



# now for treatment



  - title: '<b>Map sequences against a reference genome</b>'
    element: '#tool-search-query:visible'
    content: 'Meanwhile align the preprocessed treatment samples against the provided reference genome.'
    placement: right
    textinsert: bismark mapper
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Fbismark%2Fbismark_bowtie2%2F0.22.1%2Bgalaxy1"]

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="refGenomeSource|genomeSource"]:visible'
    placement: bottom
    content: '<h4>Select: <b>Generate Bismark indexes from Genome (fasta) in your Galaxy history</b></h4>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="singlePaired|sPaired"]:visible'
    placement: top
    content: '<h4>Select: <b>Paired-end</b></h4>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="singlePaired|mate_list_0|input_mate1"] .btn-group.ui-radiobutton > :nth-child(3):visible'
    content: 'Select dataset collection.'
    placement: bottom
    onnextclick:
      - '[tour_id="singlePaired|mate_list_0|input_mate1"] .btn-group.ui-radiobutton > :nth-child(3):visible'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="singlePaired|mate_list_0|input_mate1"]:visible'
    placement: top
    content: '<h4>Select: <b>trimmed.treat.R1</b></h4>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="singlePaired|mate_list_0|input_mate2"] .btn-group.ui-radiobutton > :nth-child(3):visible'
    content: 'Select dataset collection.'
    placement: bottom
    onnextclick:
      - '[tour_id="singlePaired|mate_list_0|input_mate2"] .btn-group.ui-radiobutton > :nth-child(3):visible'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '[tour_id="singlePaired|mate_list_0|input_mate2"]:visible'
    placement: top
    content: '<h4>Select: <b>trimmed.treat.R2</b></h4>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#execute:visible'
    content: 'For all remaining parametrisation options, we will use the provided default settings.<br>
However, for further information, please refer to the manual provided below the tool box.'
    placement: top
    postclick:
      - '#execute:visible'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#right:visible'
    content: 'Bismark processing has begun, and the results are loading in your history.'
    placement: left
    onloadwait:
      - element: '#current-history-panel .list-items > :nth-child(1) .name:contains("Bismark Mapper")'



# wait and tag



  - title: '<b>Map sequences against a reference genome</b>'
    element: '#masthead:visible'
    content: 'The Mapping tasks have been completed.'
    placement: bottom
    onloadwait:
      - element: '#current-history-panel .list-item.dataset-collection.history-content.state-loading:visible'
        count: 0
      - element: '#current-history-panel .list-item.dataset-collection.history-content.state-new:visible'
        count: 0
      - element: '#current-history-panel .list-item.dataset-collection.history-content.state-running:visible'
        count: 0
      - element: '#current-history-panel .list-item.dataset-collection.history-content.state-queued:visible'
        count: 0

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel .list-items .name:contains("mapped reads"):first'
    content: 'To keep track of the data being processed, we will use tags (1/2).'
    placement: top
    onnextclick:
      - '#current-history-panel .list-items .name:contains("mapped reads"):first'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel .list-panel .controls .tags-display:visible'
    content: '<h4>Click and enter: <b>mapped.treat</b></h4>'
    placement: bottom
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel .list-panel .controls .navigation .back:visible'
    content: 'Return to history main view'
    placement: bottom
    onnextclick:
      - '#current-history-panel .list-panel .controls .navigation .back:visible'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel .list-items .name:contains("mapped reads"):last'
    content: 'To keep track of the data being processed, we will use tags (2/2).'
    placement: top
    onnextclick:
      - '#current-history-panel .list-items .name:contains("mapped reads"):last'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel .list-panel .controls .tags-display:visible'
    content: '<h4>Click and enter: <b>mapped.ctr</b></h4>'
    placement: bottom
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel .list-panel .controls .navigation .back:visible'
    content: 'Return to history main view'
    placement: bottom
    onnextclick:
      - '#current-history-panel .list-panel .controls .navigation .back:visible'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#masthead:visible'
    content: 'You successfully completed this Galaxy atom.'
    placement: bottom
