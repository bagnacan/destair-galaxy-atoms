id: bs_tour_1a
name: 'BS-Seq analysis'
description: 'Data upload'
title_default: 'BS-Seq analysis'
steps:
  - title: '<b>Outline</b>'
    element: '#masthead:visible'
    content: 'In this tour we will upload NGS data to be analysed for methylation levels.<br>
Here, we will leverage on the <b>Data upload</b> tool provided by the Galaxy framework.'
    placement: bottom

  - title: '<b>Import the sequence datasets</b>'
    element: '.fa.fa-upload:visible'
    content: Imports data into Galaxy.
    placement: right
    onnextclick:
      - '.fa.fa-upload:visible'
    onloadwait:
      - element: '.history-size:contains("empty"):visible'

  - title: '<b>Import the sequence datasets</b>'
    element: >-
      .tab-pane.active > .upload-view-default > .upload-buttons > :nth-child(5)
      > .title
    content: 'From remote source'
    placement: bottom
    onloadclick:
      - '.tab-pane.active .upload-view-default .upload-buttons > :nth-child(3) .title:visible'
    onnextclick:
      - '.tab-pane.active .upload-view-default .upload-buttons > :nth-child(5) .title:visible'
  - title: '<b>Import the sequence datasets</b>'
    element: .upload-text-content
    content: 'Enter URLs'
    placement: bottom
    textinsert: |
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R1.N1.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R2.N1.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R1.N2.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R2.N2.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R1.N3.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R2.N3.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R1.N4.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R2.N4.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R1.N1.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R2.N1.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R1.N2.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R2.N2.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R1.N3.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R2.N3.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R1.N4.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R2.N4.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/hg38.goi.fa
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/hg38.goi.gtf
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/hg38.promoter.bed
  - title: '<b>Import the sequence datasets</b>'
    element: '#btn-start:visible'
    content: Start the upload.
    placement: bottom
    onnextclick:
      - '#btn-start:visible'
  - title: '<b>Import the sequence datasets</b>'
    element: '#btn-close:visible'
    content: Close the dialog.
    placement: bottom
    onnextclick:
      - '#btn-close:visible'
    onloadwait:
      - element: '#current-history-panel .list-item.dataset.history-content:visible'
        mincount: 1

  - title: '<b>Import the sequence datasets</b>'
    element: '#right:visible'
    content: 'The datasets are uploading in your history.<br>
These comprise:<br>
- Eight datasets collecting read mate-pairs at the 1st Trimester (control)<br>
- Eight datasets collecting read mate-pairs at the 3rd Trimester (treatment)<br>
- The reference genome and annotation<br>
- The CpG context file (10kb upstream region per gene of interest).'
    placement: left


  - title: '<b>Import the sequence datasets</b>'
    element: '#right:visible'
    onloadwait:
      - element: '#current-history-panel .list-item.dataset.history-content.state-loading:visible'
        count: 0
      - element: '#current-history-panel .list-item.dataset.history-content.state-new:visible'
        count: 0
      - element: '#current-history-panel .list-item.dataset.history-content.state-running:visible'
        count: 0
      - element: '#current-history-panel .list-item.dataset.history-content.state-queued:visible'
        count: 0
    content: 'Your data was successfully uploaded'
    placement: left

  - title: '<b>Create a collection</b>'
    element: '#right:visible'
    content: ' Multiple datasets can be organized as a collection to group them under a single name.
 This is especially useful to avoid errors during the analysis. In particular, collections help to:<br>
- Save time running the same operation on multiple datasets<br>
- Rename the collection instead of renaming every single file<br>
- Keep the history as clean as possible.<br>
Thus, we want to create as many collections as sample conditions (control/treatment) and sample mate pairs (forward/reverse).'
    placement: left

  - title: <b>Create collections</b>
    element: '.actions .icon-btn.show-selectors-btn .fa.fa-check-square-o:visible'
    content: 'Select multiple datasets'
    placement: left
    onnextclick:
      - '.actions .icon-btn.show-selectors-btn .fa.fa-check-square-o:visible'
  - title: <b>Create collections</b>
    element: .select-all
    content: 'Select all'
    placement: left
    onnextclick:
      - '.select-all:visible'

  - title: <b>Create collections</b>
    element: '.list-action-menu-btn.btn.btn-secondary.dropdown-toggle:visible'
    content: 'Choose an option'
    placement: top

  - title: <b>Create collections</b>
    element: '.list-action-menu-btn.btn.btn-secondary.dropdown-toggle:visible'
    content: 'Create collections from rules'
    placement: top
    onloadclick:
      - '.list-action-menu-btn.btn.btn-secondary.dropdown-toggle:visible'
    onnextclick:
      - '.float-right > :nth-child(9) a'

  - title: <b>Create collections</b>
    element: .creator-reset-btn
    content: 'Reset default definitions'
    placement: bottom
    onnextclick:
      - '.creator-reset-btn:visible'




  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Create a new table column (1/3)'
    placement: bottom
  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Add column from metadata'
    placement: bottom
    onloadclick:
      - '.rule-menu-column-button:visible'
    onnextclick:
      - '.rule-link-add-column-metadata'
  - title: <b>Create collections</b>
    element: '.rule-editor > :nth-child(1):visible'
    content: '<h4>Select: <b>Name</b></h4>'
    placement: right
    pointer: true
  - title: <b>Create collections</b>
    element: .rule-editor-ok
    content: 'Apply'
    placement: right
    onnextclick:
      - '.rule-editor-ok:visible'


  - title: <b>Create collections</b>
    element: .rule-menu-filter-button
    content: 'Filter for fastq data rows'
    placement: bottom
  - title: <b>Create collections</b>
    element: .rule-menu-filter-button
    content: 'Using a regular expression'
    placement: bottom
    onloadclick:
      - '.rule-menu-filter-button:visible'
    onnextclick:
      - '.rule-link-add-filter-regex'
  - title: <b>Create collections</b>
    element: '.rule-regular-expression:visible'
    content: '<h4>Enter: <b>fastq</b></h4>'
    placement: right
    pointer: true
  - title: <b>Create collections</b>
    element: .rule-editor-ok
    content: 'Apply on column A'
    placement: right
    onnextclick:
      - '.rule-editor-ok:visible'


  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Create a new table column (2/3)'
    placement: bottom
  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Add column from basename of URL'
    placement: bottom
    onloadclick:
      - '.rule-menu-column-button:visible'
    onnextclick:
      - '.rule-link-add-column-basename'
  - title: <b>Create collections</b>
    element: .rule-editor-ok
    content: 'Apply on column A'
    placement: right
    onnextclick:
      - '.rule-editor-ok:visible'



  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Create a new table column (3/3)'
    placement: bottom
  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Trim suffix'
    placement: bottom
    onloadclick:
      - '.rule-menu-column-button:visible'
    onnextclick:
      - '.rule-link-add-column-substr'

  - title: <b>Create collections</b>
    element: .rule-column-selector
    content: '<h4>Select: <b>B</b></h4>'
    placement: right
    pointer: true

  - title: <b>Create collections</b>
    element: '.rule-editor > :nth-child(2) select:visible'
    content: '<h4>Select: <b>Strip off suffix specified</b></h4>'
    placement: right
    pointer: true

  - title: <b>Create collections</b>
    element: '.rule-editor :nth-child(3) input:visible'
    content: '<h4>Enter: <b>12</b></h4>'
    placement: right
    pointer: true

  - title: <b>Create collections</b>
    element: .rule-editor-ok
    content: 'Apply on column B'
    placement: right
    onnextclick:
      - '.rule-editor-ok:visible'




  - title: <b>Create collections</b>
    element: .rule-menu-rules-button
    content: 'Create a new rule'
    placement: bottom
  - title: <b>Create collections</b>
    element: .rule-menu-rules-button
    content: 'Add column definitions'
    placement: bottom
    onloadclick:
      - '.rule-menu-rules-button:visible'
    onnextclick:
      - '.rule-link-mapping'
  - title: <b>Create collections</b>
    element: .dropdown-toggle.btn.btn-primary.mr-1
    content: 'Add a definition (1/2)'
    placement: top
  - title: <b>Create collections</b>
    element: .dropdown-toggle.btn.btn-primary.mr-1
    content: 'Select list identifier'
    placement: top
    onloadclick:
      - '.dropdown-toggle.btn.btn-primary.mr-1:visible'
    onnextclick:
      - '.rule-add-mapping-list-identifiers'

  - title: <b>Create collections</b>
    element: .rule-column-selector.rule-map-list-identifiers
    content: '<h4>Select column <b>B</b></h4>'
    placement: right
    pointer: true

  - title: <b>Create collections</b>
    element: .dropdown-toggle.btn.btn-primary.mr-1
    content: 'Add a definition (2/2)'
    placement: top
  - title: <b>Create collections</b>
    element: .dropdown-toggle.btn.btn-primary.mr-1
    content: 'Select collection name'
    placement: top
    onloadclick:
      - '.dropdown-toggle.btn.btn-primary.mr-1:visible'
    onnextclick:
      - '.rule-add-mapping-collection-name'
  - title: <b>Create collections</b>
    element: .rule-column-selector.rule-map-collection-name
    content: '<h4>Select column <b>C</b></h4>'
    placement: right
    pointer: true
  - title: <b>Create collections</b>
    element: .rule-mapping-ok
    content: 'Apply'
    placement: right
    onnextclick:
      - '.rule-mapping-ok:visible'
  - title: <b>Create collections</b>
    element: .create-collection
    content: 'Finally, create collections'
    placement: bottom
    onnextclick:
      - '.create-collection:visible'


  - title: <b>Create collections</b>
    element: '#right:visible'
    content: 'There are four collections in your history panel.'
    placement: left
    onloadwait:
      - element: '#current-history-panel .list-item.dataset-collection.history-content:visible'
        mincount: 1

  - title: <b>Create collections</b>
    element: '.actions .icon-btn.show-selectors-btn .fa.fa-check-square-o:visible'
    content: 'Close the selection view'
    placement: left
    onnextclick:
      - '.actions .icon-btn.show-selectors-btn .fa.fa-check-square-o:visible'


  - title: <b>Create collections</b>
    element: '#masthead:visible'
    content: 'The data upload and rganization has been completed.'
    placement: bottom
