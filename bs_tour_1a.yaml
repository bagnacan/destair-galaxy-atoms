id: bs_tour_1a
name: 'BS-Seq analysis'
description: 'Data upload'
title_default: 'BS-Seq analysis'
steps:
  - title: '<b>Outline</b>'
    element: '#masthead'
    content: 'In this tour we will upload NGS data to be analysed for methylation levels.<br />
Here, we will leverage on the <b>Data upload</b> tool provided by the Galaxy framework.<br /><br />
Click <b>Next</b> to start the analysis.<br />'
    placement: bottom

  - title: '<b>Import the sequence datasets</b>'
    element: '.fa.fa-upload'
    content: Imports data into Galaxy.
    placement: right
    onnextclick:
      - '.fa.fa-upload'
    onloadwait:
      - element: '#current-history-panel > .list-items > .list-item.dataset.history-content'
        count: 0
  - title: '<b>Import the sequence datasets</b>'
    element: >-
      .tab-pane.active > .upload-view-default > .upload-buttons > :nth-child(5)
      > .title
    content: 'From remote source'
    placement: bottom
    onloadclick:
      - '.tab-pane.active > .upload-view-default > .upload-buttons > :nth-child(3) > .title'
    onnextclick:
      - '.tab-pane.active > .upload-view-default > .upload-buttons > :nth-child(5) > .title'
  - title: '<b>Import the sequence datasets</b>'
    element: .upload-text-content
    content: 'Enter URLs'
    placement: bottom
    textinsert: |
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R1.N1.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R2.N1.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R1.N2.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R2.N2.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R1.N3.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R2.N3.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R1.N4.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_ctr.R2.N4.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R1.N1.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R2.N1.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R1.N2.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R2.N2.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R1.N3.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R2.N3.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R1.N4.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/PE/rrbs_treat.R2.N4.fastq.gz
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/hg38.goi.fa
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/hg38.goi.gtf
      https://github.com/destairdenbi/trainings/raw/master/raw_data/rrbs/hg38.promoter.bed
  - title: '<b>Import the sequence datasets</b>'
    element: '#btn-start'
    content: Start the upload.
    placement: bottom
    onnextclick:
      - '#btn-start'
  - title: '<b>Import the sequence datasets</b>'
    element: '#btn-close'
    content: Close the dialog.
    placement: bottom
    onnextclick:
      - '#btn-close'
.tab-pane.active > .upload-view-default > .upload-buttons > :nth-child(1) > .title'
    onloadwait:
      - element: '#current-history-panel > .list-items > .list-item.dataset.history-content'
        mincount: 1

  - title: '<b>Import the sequence datasets</b>'
    element: '#right'
    content: 'The datasets are uploading in your history.<br />
These comprise:<br />
- Eight datasets collecting read mate-pairs at the 1st Trimester (control)<br />
- Eight datasets collecting read mate-pairs at the 3rd Trimester (treatment)<br />
- The reference genome and annotation<br />
- The CpG context file.<br />
Uploaded datasets are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to continue.<br />'
    placement: left

  - title: '<b>Import the sequence datasets</b>'
    element: '#right'
    onloadwait:
      - element: '#current-history-panel > .list-items > .list-item.dataset.history-content.state-queued'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset.history-content.state-running'
        count: 0
    content: 'Your data was successfully uploaded'
    placement: left

  - title: '<b>Create a collection</b>'
    element: '#right'
    content: '
Multiple datasets can be organized as a collection to group them under<br />
a single name. This is especially useful to avoid errors during the<br />
analysis. In particular, collections help to:<br />
- Save time running the same operation on multiple datasets<br />
- Rename the collection instead of renaming every single file<br />
- Keep the history as clean as possible.<br /><br />
Click <b>Next</b> to start.<br />'
    placement: left

  - title: '<b>Create a collection</b>'
    element: '#right'
    content: 'We want to create as many collections as sample conditions <br />
(control/treatment and sample mate pairs (forward/reverse)<br />'
    placement: left

  - title: <b>Create collections</b>
    element: .fa.fa-check-square-o
    content: 'Select multiple datasets'
    placement: left
    onnextclick:
      - '.fa.fa-check-square-o'
  - title: <b>Create collections</b>
    element: .select-all
    content: 'Select all'
    placement: left
    onnextclick:
      - '.select-all'
  - title: <b>Create collections</b>
    element: '.list-action-menu-btn.btn.btn-secondary.dropdown-toggle'
    content: 'Choose an option'
    placement: top
  - title: <b>Create collections</b>
    element: '.list-action-menu-btn.btn.btn-secondary.dropdown-toggle'
    content: 'Create collections from rules'
    placement: top
    onloadclick:
      - '.list-action-menu-btn.btn.btn-secondary.dropdown-toggle'
    onnextclick:
      - '.float-right > :nth-child(9) > a'
  - title: <b>Create collections</b>
    element: .creator-reset-btn
    content: 'Reset default definitions'
    placement: bottom
    onnextclick:
      - '.creator-reset-btn'




  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Create a new table column (1/3)'
    placement: bottom
  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Add column from metadata'
    placement: bottom
    onloadclick:
      - '.rule-menu-column-button'
    onnextclick:
      - '.rule-link-add-column-metadata'
  - title: <b>Create collections</b>
    element: select
    content: '<text style="color:red">Select: <b>Name</b></text>'
    placement: right
    pointer: true
  - title: <b>Create collections</b>
    element: .rule-editor-ok
    content: 'Apply'
    placement: right
    onnextclick:
      - '.rule-editor-ok'


  - title: <b>Create collections</b>
    element: .rule-menu-filter-button
    content: 'Filter for fastq data rows'
    placement: bottom
  - title: <b>Create collections</b>
    element: .rule-menu-filter-button
    content: 'Using a regular expression'
    placement: bottom
    onloadclick:
      - '.rule-menu-filter-button'
    onnextclick:
      - '.rule-link-add-filter-regex'
  - title: <b>Create collections</b>
    element: '.rule-regular-expression'
    content: '<text style="color:red">Enter: <b>fastq</b></text>'
    placement: right
    pointer: true
  - title: <b>Create collections</b>
    element: .rule-editor-ok
    content: 'Apply on column A'
    placement: right
    onnextclick:
      - '.rule-editor-ok'


  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Create a new table column (2/3)'
    placement: bottom
  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Add column from basename of URL'
    placement: bottom
    onloadclick:
      - '.rule-menu-column-button'
    onnextclick:
      - '.rule-link-add-column-basename'
  - title: <b>Create collections</b>
    element: .rule-editor-ok
    content: 'Apply on column A'
    placement: right
    onnextclick:
      - '.rule-editor-ok'



  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Create a new table column (3/3)'
    placement: bottom
  - title: <b>Create collections</b>
    element: .rule-menu-column-button
    content: 'Trim suffix'
    placement: bottom
    onloadclick:
      - '.rule-menu-column-button'
    onnextclick:
      - '.rule-link-add-column-substr'

  - title: <b>Create collections</b>
    element: .rule-column-selector
    content: '<text style="color:red">Select: <b>B</b></text>'
    placement: right
    pointer: true

  - title: <b>Create collections</b>
    element: '.rule-editor > :nth-child(2) > select'
    content: '<text style="color:red">Select: <b>Strip off suffix specified</b></text>'
    placement: right
    pointer: true

  - title: <b>Create collections</b>
    element: ':nth-child(3) > input'
    content: '<text style="color:red">Enter: <b>12</b></text>'
    placement: right
    pointer: true

  - title: <b>Create collections</b>
    element: .rule-editor-ok
    content: 'Apply on column B'
    placement: right
    onnextclick:
      - '.rule-editor-ok'




  - title: <b>Create collections</b>
    element: .rule-menu-rules-button
    content: 'Create a new rule'
    placement: bottom
  - title: <b>Create collections</b>
    element: .rule-menu-rules-button
    content: 'Add rules'
    placement: bottom
    onloadclick:
      - '.rule-menu-rules-button'
    onnextclick:
      - '.rule-link-mapping'
  - title: <b>Create collections</b>
    element: .dropdown-toggle.btn.btn-primary.mr-1
    content: 'Add a definition (1/2)'
    placement: top
  - title: <b>Create collections</b>
    element: .dropdown-toggle.btn.btn-primary.mr-1
    content: 'Select list identifier'
    placement: top
    onloadclick:
      - '.dropdown-toggle.btn.btn-primary.mr-1'
    onnextclick:
      - '.rule-add-mapping-list-identifiers'

  - title: <b>Create collections</b>
    element: .rule-column-selector.rule-map-list-identifiers
    content: '<text style="color:red">Select column <b>B</b></text>'
    placement: right
    pointer: true

  - title: <b>Create collections</b>
    element: .dropdown-toggle.btn.btn-primary.mr-1
    content: 'Add a definition (2/2)'
    placement: top
  - title: <b>Create collections</b>
    element: .dropdown-toggle.btn.btn-primary.mr-1
    content: 'Select collection name'
    placement: top
    onloadclick:
      - '.dropdown-toggle.btn.btn-primary.mr-1'
    onnextclick:
      - '.rule-add-mapping-collection-name'
  - title: <b>Create collections</b>
    element: .rule-column-selector.rule-map-collection-name
    content: '<text style="color:red">Select column <b>C</b></text>'
    placement: right
    pointer: true
  - title: <b>Create collections</b>
    element: .rule-mapping-ok
    content: 'Apply'
    placement: right
    onnextclick:
      - '.rule-mapping-ok'
  - title: <b>Create collections</b>
    element: .create-collection
    content: 'Finally, create collections'
    placement: bottom
    onnextclick:
      - '.create-collection'

  - title: <b>Create collections</b>
    element: '#masthead'
    content: 'The data upload and rganization has been completed.<br />'
    placement: bottom
    onloadwait:
      - element: '#current-history-panel > .list-items > .list-item.dataset-collection.history-content.state-queued'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset-collection.history-content.state-running'
        count: 0
