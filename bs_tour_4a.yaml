id: bs_tour_4a
name: 'BS-Seq analysis'
description: 'Alignment of sequence reads against a reference genome using Bismark'
title_default: 'BS-Seq analysis'
steps:
  - title: '<b>Outline</b>'
    element: '#masthead'
    content: 'In this tour we will align MethylC sequenced reads against a reference<br />
genome. This represents a necessary task for the quantification of<br />
methilated Cytosines in genomic CpG, CHG and CHH contexts which can be later<br />
used to infer and evaluate e.g. enhancer promoter or gene body<br />
methylation rates.<br />
Here, we will leverage on <b>Bismark</b>.<br /><br />'
    placement: bottom

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#tool-search-query'
    content: 'Look for the <b>Bismark Mapper</b> tool.<br />
Bismark maps bisulfite treated sequencing reads to a genome of interest<br />
and performs methylation calls in a single step.<br />
Here we want to align the preprocessed sequences of control samples against<br />
the provided reference genome.<br /><br />'
    placement: right
    textinsert: bismark mapper
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Fbismark%2Fbismark_bowtie2%2F0.22.1%2Bgalaxy1"]



# bismark params



  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="refGenomeSource|genomeSource"]'
    placement: bottom
    content: '<text style="color:red">Select: <b>Generate Bismark indexes from Genome (fasta) in your Galaxy history</b></text>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="singlePaired|sPaired"]'
    placement: top
    content: '<text style="color:red">Select: <b>Paired-end</b></text>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="singlePaired|mate_list_0|input_mate1"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton > :nth-child(3)'
    content: 'Select dataset collection.<br /><br />'
    placement: bottom
    onnextclick:
      - 'div[tour_id="singlePaired|mate_list_0|input_mate1"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton > :nth-child(3)'

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="singlePaired|mate_list_0|input_mate1"]'
    placement: top
    content: '<text style="color:red">Select: <b>trimmed.ctr.R1</b></text>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="singlePaired|mate_list_0|input_mate2"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton > :nth-child(3)'
    content: 'Select dataset collection.<br /><br />'
    placement: bottom
    onnextclick:
      - 'div[tour_id="singlePaired|mate_list_0|input_mate2"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton > :nth-child(3)'

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="singlePaired|mate_list_0|input_mate2"]'
    placement: top
    content: '<text style="color:red">Select: <b>trimmed.ctr.R2</b></text>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#execute'
    content: 'For all remaining parametrisation options, we will use the provided<br />
default settings. However, for further information, please refer to the<br />
manual provided below the tool box.<br /><br />'
    placement: top
    postclick:
      - '#execute'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#right'
    content: 'Bismark processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />'
    placement: left
    onloadwait:
      - element: '#current-history-panel > .list-items > :nth-child(1) > .title-bar > .title > span:contains("Bismark Mapper")'



# now for treatment



  - title: '<b>Map sequences against a reference genome</b>'
    element: '#tool-search-query'
    content: 'Meanwhile align the preprocessed treatment samples against<br />
the provided reference genome.<br /><br />'
    placement: right
    textinsert: bismark mapper
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Fbismark%2Fbismark_bowtie2%2F0.22.1%2Bgalaxy1"]

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="refGenomeSource|genomeSource"]'
    placement: bottom
    content: '<text style="color:red">Select: <b>Generate Bismark indexes from Genome (fasta) in your Galaxy history</b></text>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="singlePaired|sPaired"]'
    placement: top
    content: '<text style="color:red">Select: <b>Paired-end</b></text>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="singlePaired|mate_list_0|input_mate1"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton > :nth-child(3)'
    content: 'Select dataset collection.<br /><br />'
    placement: bottom
    onnextclick:
      - 'div[tour_id="singlePaired|mate_list_0|input_mate1"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton > :nth-child(3)'

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="singlePaired|mate_list_0|input_mate1"]'
    placement: top
    content: '<text style="color:red">Select: <b>trimmed.treat.R1</b></text>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="singlePaired|mate_list_0|input_mate2"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton > :nth-child(3)'
    content: 'Select dataset collection.<br /><br />'
    placement: bottom
    onnextclick:
      - 'div[tour_id="singlePaired|mate_list_0|input_mate2"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton > :nth-child(3)'

  - title: '<b>Map sequences against a reference genome</b>'
    element: 'div[tour_id="singlePaired|mate_list_0|input_mate2"]'
    placement: top
    content: '<text style="color:red">Select: <b>trimmed.treat.R2</b></text>'
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#execute'
    content: 'For all remaining parametrisation options, we will use the provided<br />
default settings. However, for further information, please refer to the<br />
manual provided below the tool box.<br /><br />'
    placement: top
    postclick:
      - '#execute'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#right'
    content: 'Bismark processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />'
    placement: left
    onloadwait:
      - element: '#current-history-panel > .list-items > :nth-child(1) > .title-bar > .title > span:contains("Bismark Mapper")'



# wait and tag



  - title: '<b>Map sequences against a reference genome</b>'
    element: '#masthead'
    content: 'The Mapping tasks have been completed.<br />'
    placement: bottom
    onloadwait:
      - element: '#current-history-panel > .list-items > .list-item.dataset-collection.history-content.state-loading'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset-collection.history-content.state-new'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset-collection.history-content.state-running'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset-collection.history-content.state-queued'
        count: 0

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel > .list-items > .list-item > .title-bar > .title > span:contains("mapped reads"):first'
    content: 'To keep track of the data being processed, we will use tags (1/2).<br />'
    placement: top
    onnextclick:
      - '#current-history-panel > .list-items > .list-item > .title-bar > .title > span:contains("mapped reads"):first'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel > .list-panel > .controls > .tags-display'
    content: '<text style="color:red">Enter and confirm by return keypress: <b>mapped.treat</b></text>'
    placement: top
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel > .list-panel > .controls > .navigation > .back'
    content: 'Return to history main view'
    placement: bottom
    onnextclick:
      - '#current-history-panel > .list-panel > .controls > .navigation > .back'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel > .list-items > .list-item > .title-bar > .title > span:contains("mapped reads"):last'
    content: 'To keep track of the data being processed, we will use tags (2/2).<br />'
    placement: top
    onnextclick:
      - '#current-history-panel > .list-items > .list-item > .title-bar > .title > span:contains("mapped reads"):last'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel > .list-panel > .controls > .tags-display'
    content: '<text style="color:red">Enter and confirm by return keypress: <b>mapped.ctr</b></text>'
    placement: top
    pointer: true

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#current-history-panel > .list-panel > .controls > .navigation > .back'
    content: 'Return to history main view'
    placement: bottom
    onnextclick:
      - '#current-history-panel > .list-panel > .controls > .navigation > .back'

  - title: '<b>Map sequences against a reference genome</b>'
    element: '#masthead'
    content: 'You successfully completed this Galaxy atom<br />'
    placement: bottom
