id: bs_tour_3a
name: 'Quantification of methylated reads within a CpG context'
description: 'Quantification of methylated reads within a CpG context using Samtools and MethylDackel'
title_default: 'Quantification of methylated reads within a CpG context'
steps:
  - title: '<b>Outline</b>'
    element: ''
    content: 'In this tour we will infer genome-wide methilation rates in a CpG context.<br />Here, we will leverage on two tools: <b>Samtools</b>, to extract properly paired sequences from the aligned input data, and <b>MethylDackel</b> to quantify the methylated reads of the provided CpG context.<br />
Click <b>Next</b> to start the analysis.<br />'
    backdrop: true

  - title: '<b>Extract properly paired sequences</b>'
    element: '#tool-search-query'
    content: 'Look for <b>Samtools sort</b>.<br /><br />
Click <b>Next</b> to load it.<br />'
    placement: right
    textinsert: samtools sort
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fdevteam%2Fsamtools_sort%2Fsamtools_sort%2F2.0.3"]

  - title: '<b>Extract properly paired sequences</b>'
    element: 'div[tour_id="input1"]'
    content: 'Click on the dataset collection icon, and select the 1st Bismark-processed dataset collection.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Extract properly paired sequences</b>'
    element: 'div[tour_id="input1"]'
    content: 'For all remaining parametrisation options, we will use the provided default settings. However, for further information, please refer to the manual provided below the tool box.<br /><br />
Click <b>Next</b> to execute.<br />'
    placement: bottom
    postclick:
      - '#execute'

  - title: '<b>Extract properly paired sequences</b>'
    element: '#right'
    content: 'Samtools sort processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to repeat the same operation on the 2nd Bismark-processed dataset collection.<br />'
    placement: left

  - title: '<b>Extract properly paired sequences</b>'
    element: '#right'
    content: 'Repeat the same operation for the 2nd Bismark-processed dataset collection:<br />
- Click on the last result produced by <b>Samtools sort</b><br />
- Click on the <b>Run this job again</b> icon<br />
- Change the input dataset collection to the 2nd Bismark-processed dataset collection<br />
- Execute.<br /><br />'
    placement: left

  - title: '<b>Extract properly paired sequences</b>'
    element: '#right'
    content: 'Samtools sort processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to proceed extracting properly paired sequences<br />'
    placement: left

  - title: '<b>Extract properly paired sequences</b>'
    element: '#tool-search-query'
    content: 'Look for <b>Samtools filter</b>.<br /><br />
Click <b>Next</b> to load it.<br />'
    placement: right
    textinsert: samtools filter
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fdevteam%2Fsamtool_filter2%2Fsamtool_filter2%2F1.8%2Bgalaxy1"]

  - title: '<b>Extract properly paired sequences</b>'
    element: 'div[tour_id="input1"]'
    content: 'Click on the dataset collection icon, and select the 1st samtools-sort-processed dataset collection.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Extract properly paired sequences</b>'
    element: 'div[tour_id="flag|reqBits"]'
    content: 'Select <b>yes</b>, then chose <b>Read is mapped in a proper pair</b>.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Extract properly paired sequences</b>'
    element: 'div[tour_id="flag|reqBits"]'
    content: 'For all remaining parametrisation options, we will use the provided default settings. However, for further information, please refer to the manual provided below the tool box.<br /><br />
Click <b>Next</b> to execute.<br />'
    placement: bottom
    postclick:
      - '#execute'

  - title: '<b>Extract properly paired sequences</b>'
    element: '#right'
    content: 'Samtools filter processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to repeat the same operation on the 2nd Samtools-sort-processed dataset collection.<br />'
    placement: left

  - title: '<b>Extract properly paired sequences</b>'
    element: '#right'
    content: 'Repeat the same operation for the 2nd Samtools-sort-processed dataset collection:<br />
- Click on the last result produced by <b>Samtools filter</b><br />
- Click on the <b>Run this job again</b> icon<br />
- Change the input dataset collection to the 2nd Samtools-sort-processed dataset collection<br />
- Execute.<br /><br />'
    placement: left

  - title: '<b>Extract properly paired sequences</b>'
    element: '#right'
    content: 'Samtools filter processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to proceed extracting properly paired sequences.<br />'
    placement: left

  - title: '<b>Quantify the methylated reads</b>'
    element: '#tool-search-query'
    content: 'Look for <b>MethylDackel</b>.<br /><br />
Click <b>Next</b> to load it.<br />'
    placement: right
    textinsert: methyldackel
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Fpileometh%2Fpileometh%2F0.3.0.1"]

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="input_sortedAlignBAM"]'
    content: 'Click on the dataset collection icon, and select the 1st samtools-filter-processed dataset collection.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="main_task|mergeContext"]'
    content: 'Select <b>yes</b>.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="main_task|mergeContext"]'
    content: 'For all remaining parametrisation options, we will use the provided default settings. However, for further information, please refer to the manual provided below the tool box.<br /><br />
Click <b>Next</b> to execute.<br />'
    placement: bottom
    postclick:
      - '#execute'

  - title: '<b>Quantify the methylated reads</b>'
    element: '#right'
    content: 'MethylDackel processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to repeat the same operation on the 2nd Samtools-filter-processed dataset collection.<br />'
    placement: left

  - title: '<b>Quantify the methylated reads</b>'
    element: '#right'
    content: 'Repeat the same operation for the 2nd Samtools-filter-processed dataset collection:<br />
- Click on the last result produced by <b>MethylDackel</b><br />
- Click on the <b>Run this job again</b> icon<br />
- Change the input dataset collection to the 2nd Samtools-filter-processed dataset collection<br />
- Execute.<br /><br />'
    placement: left

  - title: '<b>Quantify the methylated reads</b>'
    element: '#right'
    content: 'MethylDackel processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to proceed quantifying the methylated reads.<br />'
    placement: left

  - title: '<b>Quantify the methylated reads</b>'
    element: '#tool-search-query'
    content: 'Look for <b>Select last lines from a dataset</b>.<br /><br />
Click <b>Next</b> to load it.<br />'
    placement: right
    textinsert: select last lines
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Ftext_processing%2Ftp_tail_tool%2F1.1.0"]

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="infile"]'
    content: 'Click on the dataset collection icon, and select the 1st MethylDackel-processed dataset collection (no suffix).<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="num_lines"]'
    content: 'Set the number of lines to 2.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="num_lines"]'
    content: 'For all remaining parametrisation options, we will use the provided default settings. However, for further information, please refer to the manual provided below the tool box.<br /><br />
Click <b>Next</b> to execute.<br />'
    placement: bottom
    postclick:
      - '#execute'

  - title: '<b>Quantify the methylated reads</b>'
    element: '#right'
    content: 'Select last lines processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to repeat the same operation on the 2nd MethylDackel-processed dataset collection.<br />'
    placement: left

  - title: '<b>Quantify the methylated reads</b>'
    element: '#tool-search-query'
    content: 'Look for <b>Select last lines from a dataset</b>.<br /><br />
Click <b>Next</b> to load it.<br />'
    placement: right
    textinsert: select last lines
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Ftext_processing%2Ftp_tail_tool%2F1.1.0"]

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="infile"]'
    content: 'Click on the dataset collection icon, and select the 2nd MethylDackel-processed dataset collection (no suffix).<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="num_lines"]'
    content: 'Set the number of lines to 2.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: bottom

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="num_lines"]'
    content: 'For all remaining parametrisation options, we will use the provided default settings. However, for further information, please refer to the manual provided below the tool box.<br /><br />
Click <b>Next</b> to execute.<br />'
    placement: bottom
    postclick:
      - '#execute'

  - title: '<b>Quantify the methylated reads</b>'
    element: '#right'
    content: 'Select last lines processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to proceed quantifying the methylated reads.<br />'
    placement: left

  - title: '<b>Quantify the methylated reads</b>'
    element: '#tool-search-query'
    content: 'Look for <b>Concatenate datasets</b>.<br /><br />
Click <b>Next</b> to load it.<br />'
    textinsert: concatenate dasets
    placement: right
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Ftext_processing%2Ftp_cat%2F0.1.0"]

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="inputs"]'
    content: 'Click on the dataset collection icon, and select the 1st select-last-line-processed dataset collection.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: right

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="inputs"]'
    content: 'For all remaining parametrisation options, we will use the provided default settings. However, for further information, please refer to the manual provided below the tool box.<br /><br />
Click <b>Next</b> to execute.<br />'
    placement: bottom
    postclick:
      - '#execute'

  - title: '<b>Quantify the methylated reads</b>'
    element: '#right'
    content: 'Concatenate datasets processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to repeat the same operation on the 2nd select-last-line-processed dataset collection.<br />'
    placement: left

  - title: '<b>Quantify the methylated reads</b>'
    element: '#tool-search-query'
    content: 'Look for <b>Concatenate datasets</b>.<br /><br />
Click <b>Next</b> to load it.<br />'
    textinsert: concatenate dasets
    placement: right
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Ftext_processing%2Ftp_cat%2F0.1.0"]

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="inputs"]'
    content: 'Click on the dataset collection icon, and select the 2nd select-last-line-processed dataset collection.<br /><br />
Click <b>Next</b> to overview further parametrisation options.<br />'
    placement: right

  - title: '<b>Quantify the methylated reads</b>'
    element: 'div[tour_id="inputs"]'
    content: 'For all remaining parametrisation options, we will use the provided default settings. However, for further information, please refer to the manual provided below the tool box.<br /><br />
Click <b>Next</b> to execute.<br />'
    placement: bottom
    postclick:
      - '#execute'

  - title: '<b>Quantify the methylated reads</b>'
    element: '#right'
    content: 'Concatenate datasets processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br /><br />
Click <b>Next</b> to proceed quantifying the methylated reads.<br />'
    placement: left


  - title: Step 80
    element: '#tool-search-query'
    content: search for sort data
    placement: right
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Ftext_processing%2Ftp_sort_header_tool%2F1.1.1"]
        .tool-old-link
  - title: Step 81
    element: 'div[tour_id="infile"]'
    content: >-
      select multiple datasets - second icon - of first and second concatenated
      methylation data
    placement: right
  - title: Step 82
    element: 'div[tour_id="sortkeys_0|style"]'
    content: sort column one by version-sort
    placement: right
  - title: Step 83
    content: insert column 2 and sort it numerically -n
    placement: right
  - title: Step 84
    element: insert column 3 and sort it numerically -n
    content: ''
    placement: left
    postclick:
      - '#execute'
  - title: Step 85
    element: '#tool-search-query'
    content: search for bedtools merge
    placement: right
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fiuc%2Fbedtools%2Fbedtools_mergebed%2F2.27.1"]
        .tool-old-link
  - title: Step 86
    element: 'div[tour_id="input"]'
    content: >-
      select multiple datasets as input - second icon - of first and second
      sorted, concatenated methylation data
    placement: right
  - title: Step 87
    content: insert and apply operation on column 4 - mean
    placement: right
    postclick:
      - '#execute'
  - title: Step 88
    element: '#tool-panel-upload-button'
    content: upload regions of interest file - e.g. promoter regions
    placement: right
  - title: Step 89
    element: '#regular .upload-view-default .upload-box input'
    content: ''
    placement: right
  - title: Step 90
    element: '#btn-local'
    content: ''
    placement: right
  - title: Step 91
    element: '#btn-start'
    content: ''
    placement: left
  - title: Step 92
    element: '#btn-close'
    content: close upload dialog
    placement: left
  - title: Step 93
    element: '#tool-search-query'
    content: search for bedtools intersect
    placement: right
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fiuc%2Fbedtools%2Fbedtools_intersectbed%2F2.27.1%2Bgalaxy1"]
        .tool-old-link
  - title: Step 94
    element: 'div[tour_id="inputA"]'
    content: select single dataset  - first icon - of promters
    placement: right
  - title: Step 95
    element: 'div[tour_id="reduce_or_iterate|inputB"]'
    content: >-
      select multiple datasests  - second icon - of first and second merged,
      meaned methylation data
    placement: right
  - title: Step 96
    element: 'div[tour_id="overlap_mode"]'
    content: click in the textbox an select option - perform a left outer join (-loj)
    placement: right
  - title: Step 97
    element: 'div[tour_id="sorted"]'
    content: enable sorted input
    placement: right
    postclick:
      - '#execute'
  - title: Step 98
    element: '#tool-search-query'
    content: search for bedtools merge
    placement: right
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fiuc%2Fbedtools%2Fbedtools_mergebed%2F2.27.1"]
        .tool-old-link
  - title: Step 99
    element: 'div[tour_id="input"]'
    content: >-
      select multiple datasets - second icon - of promoter intersected, meaned
      methylation data
    placement: right
  - title: Step 100
    element: >-
      button[class="ui-button-default btn btn-secondary float-none
      form-repeat-add"]
    content: apply operation on column 4 - distinct
    placement: right
  - title: Step 100
    element: >-
      button[class="ui-button-default btn btn-secondary float-none
      form-repeat-add"]
    content: apply operation on column 8 - mean
    placement: right
    postclick:
      - '#execute'
  - title: Step 101
    element: '#tool-search-query'
    content: search for join two files
    placement: right
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Ftext_processing%2Ftp_easyjoin_tool%2F1.1.1"]
        .tool-old-link
  - title: Step 102
    element: 'div[tour_id="infile1"]'
    content: >-
      select single dataset - first icon - first merged, meaned promoter
      methylation
    placement: right
  - title: Step 103
    element: 'div[tour_id="column1"]'
    content: select column 2 to join by position
    placement: right
  - title: Step 104
    element: 'div[tour_id="infile2"]'
    content: >-
      select single dataset - first icon - second merged, meaned promoter
      methylation
    placement: right
  - title: Step 105
    element: 'div[tour_id="column2"]'
    content: select column 2 to join by position
    placement: right
    postclick:
      - '#execute'
  - title: Step 107
    element: '#tool-search-query'
    content: search for text reformatting with awk
    placement: right
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fbgruening%2Ftext_processing%2Ftp_awk_tool%2F1.1.1"]
        .tool-old-link
  - title: Step 108
    element: 'div[tour_id="infile"]'
    content: >-
      select single dataset - first icon - of joined first and second mean
      promoter methylation data sets
    placement: right
  - title: Step 109
    element: 'div[tour_id="code"]'
    content: >-
      enter awk code to calculate log2 fold-change {print $4"\t"($5 < $9 ?
      (log($9+1)-log($5+1))/log(2) : -(log($5+1)-log($9+1))/log(2))}
    placement: right
    postclick:
      - '#execute'
