id: bs_tour_2a
name: 'BS-Seq analysis'
description: 'Quality control and adapter clipping with FastQC and Cutadapt'
title_default: 'BS-Seq analysis'
steps:
  - title: '<b>Outline</b>'
    element: '#masthead'
    content: 'In this tour, we will carry out quality control analysis of BS-Seq data. This represents the first task in analysing raw high throughput sequence reads, because it provides an overview of the overall quality of data, as well as a mean to remove low quality sequence content from reads that might ultimately bias the interpretation of results.<br />
Here, we will leverage on two tools: <b>FastQC</b>, to assess the quality of the provided sequences, and <b>Cutadapt</b>, to remove adpater content from sequencing reads.<br /><br />
Click <b>Next</b> to start the analysis.<br />'
    position: bottom

  - title: '<b>Quality control</b>'
    element: '#tool-search-query'
    content: 'Look for the <b>FastQC</b> tool.<br />
FastQC plots the overall quality of the input datasets, providing a starting point for interpreting NGS data.<br /><br />
Click <b>Next</b> to load it.<br />'
    placement: right
    textinsert: fastqc
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fdevteam%2Ffastqc%2Ffastqc%2F0.72%2Bgalaxy1"]



# fastqc



  - title: '<b>Quality control</b>'
    element: 'div[tour_id="input_file"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton > :nth-child(2)'
    content: 'Select multiple datasets.<br /><br />'
    placement: bottom
    onnextclick:
      - 'div[tour_id="input_file"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton > :nth-child(2)'

  - title: '<b>Quality control</b>'
    element: 'div[tour_id="input_file"] > .ui-form-field > .ui-select-content > .ui-select-multiple.ui-select'
    content: 'Select all imported control and treated datasets.<br /><br />'
    placement: bottom
    select:
      - 'div[tour_id="input_file"] .ui-form-field .ui-select-content .ui-select-multiple.ui-select .select > :nth-child(n+1)'

  - title: '<b>Quality control</b>'
    element: '#execute'
    content: 'For all remaining parametrisation options, we will use default settings.<br/ > However, for further information, please refer to the manual provided below the tool box.<br />'
    placement: top
    postclick:
      - '#execute'

  - title: '<b>Quality control</b>'
    element: '#right'
    content: 'FastQC processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br />'
    placement: left
    onloadwait:
      - element: '#current-history-panel > .list-items > :nth-child(1) > .title-bar > .title > span:contains("FastQC")'

  - title: '<b>Quality control</b>'
    element: '#right'
    onloadwait:
      - element: '#current-history-panel > .list-items > .list-item.dataset.history-content.state-loading'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset.history-content.state-new'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset.history-content.state-running'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset.history-content.state-queued'
        count: 0
    content: 'FastQC processing completed.'
    placement: left

  - title: '<b>Quality control</b>'
    element: '#current-history-panel > .list-items > :nth-child(2) > .primary-actions > .display-btn > .fa'
    content: 'Open a FastQC report.'
    onnextclick:
      - '#current-history-panel > .list-items > :nth-child(2) > .primary-actions > .display-btn > .fa'
    placement: left

  - title: '<b>Quality control</b>'
    element: '#masthead'
    content: 'FastQC generated diverse plots to assess the quality, adapter content, contamination of the input sequence reads.'
    placement: bottom

  - title: '<b>Quality control</b>'
    element: '#iframe-helper'
    content: 'The <b>Per base sequence quality</b> plot shows the average quality scores of all reads of each sequence of the provided input dataset.<br /> The Y axis shows the quality score: the higher, the better the base call. The background color of the graph divides the base call operation into:<br />
- Very good quality (green)<br />
- Reasonable quality (orange)<br />
- Poor quality (red).<br />
The quality of each call usually degrades as the sequencing run progresses. Here however, each provided input dataset shows lower average quality scores at the beginning of each sequence. Although these scores still account for reasonable quality reads, a reason behind this trend might be that the image scanner focus had to be recalibrated during the first sequence run cycles.<br /> More information on the <b>Per base sequence quality</b> plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/2%20Per%20Base%20Sequence%20Quality.html" target="_blank">here</a>.<br />'
    placement: right
    iframeelement: '.summary > ul > :nth-child(2) > img'
    onloadclick:
      - '.summary > ul > :nth-child(2) > a'

  - title: '<b>Quality control</b>'
    element: '#iframe-helper'
    content: 'The <b>Per sequence quality scores</b> plot shows if a subset of sequences have universally low quality values.<br />If a significant subset of sequences in a run have overall low quality scores, this suggests that some kind of systematic problem occured during the sequencing experiment. Here, the entire sequence set scores well, showing the desired overall behavior for a sequence set: a peak (large sequence subset) showing a good score, and a short tail (sequence subset) scoring lower, although still well.<br /> More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/3%20Per%20Sequence%20Quality%20Scores.html" target="_blank">here</a>.<br />'
    placement: right
    iframeelement: '.summary > ul > :nth-child(3) > img'
    onloadclick:
      - '.summary > ul > :nth-child(3) > a'

  - title: '<b>Quality control</b>'
    element: '#iframe-helper'
    content: 'The <b>Per base sequence content</b> plot shows the percentage of occurrence of each base in each position of each sequence.<br /> The four bases <b>should be imbalanced</b> due to the Bisulfite convertion. In case of RRBS data, the first four read positions show a clear biased due to the MspI-(CCGG)-cutting-site. Furthermore, some libraries also ligate an 5prime, up to three nucleotides long diversity adapter, which should be previously trimmed off according to the manufacturers guideline. More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/4%20Per%20Base%20Sequence%20Content.html" target="_blank">here</a>.<br />'
    placement: right
    iframeelement: '.summary > ul > :nth-child(4) > img'
    onloadclick:
      - '.summary > ul > :nth-child(4) > a'

  - title: '<b>Quality control</b>'
    element: '#iframe-helper'
    content: 'The <b>Per sequence GC content</b> plot shows the GC content distribution of the provided sample.<br />Typically, this should follow a normal distribution. However, due to the Bisulfite convertion, an <b>unusually shaped distribution is nothing to worry about</b>. Here, each provided sample aligns to the theoretical (blue line) CG distribution.<br />More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/5%20Per%20Sequence%20GC%20Content.html" target="_blank">here</a>.<br />'
    placement: right
    iframeelement: '.summary > ul > :nth-child(5) > img'
    onloadclick:
      - '.summary > ul > :nth-child(5) > a'

  - title: '<b>Quality control</b>'
    element: '#iframe-helper'
    content: 'The <b>Per base N content</b> plot shows the percentage of N occurrences in the sequence reads.<br />If a sequencer is unable to make a base call with confidence, then it will place an N, where N represents an ambiguous nucleotide: a base which could not be correctly identified.<br />High number of Ns are a sign of low quality sequence reads, which might be due to transient problems occurring during the sequencing experiment. Here, each provided sample shows the ideal percentage of N at each position in the sequence set, accounting for a good sequencing run.<br />More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/6%20Per%20Base%20N%20Content.html" target="_blank">here</a>.<br />'
    placement: right
    iframeelement: '.summary > ul > :nth-child(6) > img'
    onloadclick:
      - '.summary > ul > :nth-child(6) > a'

  - title: '<b>Quality control</b>'
    element: '#iframe-helper'
    content: 'The <b>Sequence length distribution</b> plot shows the distribution of sequence read length.<br />For NGS sequencers generating uniform sequence reads, this will result in a spike around a fixed length value.<br />More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/7%20Sequence%20Length%20Distribution.html" target="_blank">here</a>.<br />'
    placement: right
    iframeelement: '.summary > ul > :nth-child(7) > img'
    onloadclick:
      - '.summary > ul > :nth-child(7) > a'

  - title: '<b>Quality control</b>'
    element: '#iframe-helper'
    content: 'The <b>Sequence duplication levels</b> plot shows the relative number of sequences with different degrees of duplication. Here, the blue line represents the full sequence set, showing how its duplication levels are distributed; the red line instead, represents the de-duplicated sequences, plotting the proportions of deduplicated sequence sets which come from different duplication levels in the original data. Bisulfite sequencing data derives from short fragments. Thus, an increased <b>3prime duplication level is referable to sequenced adapter content<b>. In addition, <b>RRBS data sets usually tend to have duplicons</b> which must not be removed, unless PCR duplicons can be truly identified using random barcodes. Please consult your library preparation guidelines and manufacturers manual on data preprocessing. <br />More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/8%20Duplicate%20Sequences.html" target="_blank">here</a>.<br />'
    placement: right
    iframeelement: '.summary > ul > :nth-child(8) > img'
    onloadclick:
      - '.summary > ul > :nth-child(8) > a'

  - title: '<b>Quality control</b>'
    element: '#iframe-helper'
    content: 'The <b>Overrepresented sequences</b> section shows all sequence making up for more than 0.1% of the total number of sequences in the dataset.<br />If a sequence is overrepresented, this means that it is either highly biologically significant, holds adapter content or is a contaminant for the current library. Here, each provided sequence dataset shows no overrepresented sequences.<br />More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/9%20Overrepresented%20Sequences.html" target="_blank">here</a>.<br />'
    placement: right
    iframeelement: '.summary > ul > :nth-child(9) > img'
    onloadclick:
      - '.summary > ul > :nth-child(9) > a'

  - title: '<b>Quality control</b>'
    element: '#iframe-helper'
    content: 'The <b>Adapter content</b> plot shows the amount of residual tag sequences within the sample.<br />Base frequencies across the reads should follow a uniform distribution, on the contrary, uneven distributions (high frequencies for certain bases over several positions) indicate remaining sequence artifacts within the dataset. Due to short fragment sizes, <b>3prime adapter content can occur</b>.<br />More information on this plot can be found <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/10%20Adapter%20Content.html" target="_blank">here</a>.<br />'
    placement: right
    iframeelement: '.summary > ul > :nth-child(10) > img'
    onloadclick:
      - '.summary > ul > :nth-child(10) > a'

  - title: '<b>Quality control</b>'
    element: '#masthead'
    content: 'Now that the quality of the input dataset have been assessed, it is necessary to clip off adapters.<br />'
    placement: bottom



# adapter clipping



  - title: '<b>Adapter clipping</b>'
    element: '#tool-search-query'
    content: 'Look for the <b>Cutadapt</b> tool.<br />
Cutadapt is an adapter/sequence trim/removal tool, which searches for contaminants, adapters, and low quality score reads, and ultimately removes them to improve the overall quality of the input datasets.<br />'
    placement: bottom
    textinsert: cutadapt
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Flparsons%2Fcutadapt%2Fcutadapt%2F1.16.6"]


  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="library|type"]'
    content: '<text style="color:red">Select: <b>Paired-end</b></text>'
    pointer: true
    placement: bottom


  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="library|input_1"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton:last > :nth-child(3)'
    content: 'Select dataset collection.<br /><br />'
    placement: bottom
    onnextclick:
      - 'div[tour_id="library|input_1"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton:last > :nth-child(3)'


  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="library|input_1"]:last'
    content: '<text style="color:red">Select: <b>ctr.R1</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="library|input_2"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton:last > :nth-child(3)'
    content: 'Select dataset collection.<br /><br />'
    placement: bottom
    onnextclick:
      - 'div[tour_id="library|input_2"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton:last > :nth-child(3)'

  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="library|input_2"]:last'
    content: '<text style="color:red">Select: <b>ctr.R2</b></text>'
    pointer: true
    placement: top





  - title: '<b>Adapter clipping</b>'
    element: ':nth-child(3) > :nth-child(3) > .portlet-content > .portlet-body > :nth-child(1) > :nth-child(1) > .ui-form-field > :nth-child(1) > :nth-child(2) > .ui-button-default'
    placement: top
    content: 'Insert Illumina universal 3prime adapter'
    onnextclick:
      - ':nth-child(3) > :nth-child(3) > .portlet-content > .portlet-body > :nth-child(1) > :nth-child(1) > .ui-form-field > :nth-child(1) > :nth-child(2) > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r1|adapters_0|adapter_source|adapter_source_list"]'
    placement: top
    content: '<text style="color:red">Select: <b>Enter custom sequence</b></text>'
    pointer: true
    placement: top


  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r1|adapters_0|adapter_source|adapter"]:first'
    placement: top
    content: '<text style="color:red">Enter: <b>AGATCGGAAGAGC</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>' 
    element: ':nth-child(3) > :nth-child(3) > :nth-child(2) > :nth-child(1) > :nth-child(1) > :nth-child(1) > :nth-child(3) > :nth-child(1) > :nth-child(2) > .ui-button-default'
    placement: top
    content: 'Add a second adapter.<br />In RRBS-Seq data, a methylation bias is introduced due to an end-repair step in the library preparation necessary because of an unpaired overhang at the MspI-(CCGG)-cutting-site. If a read has adapter content, the CpG/TpG island should be clipped as well. Therefore, we use a the previously entered adapter sequence prefixed by the sequence YG in IUPAC code.'
    onnextclick:
      - ':nth-child(3) > :nth-child(3) > :nth-child(2) > :nth-child(1) > :nth-child(1) > :nth-child(1) > :nth-child(3) > :nth-child(1) > :nth-child(2) > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r1|adapters_1|adapter_source|adapter_source_list"]'
    placement: top
    content: '<text style="color:red">Select: <b>Enter custom sequence</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r1|adapters_1|adapter_source|adapter"]:first'
    placement: top
    content: '<text style="color:red">Enter: <b>YGAGATCGGAAGAGC</b></text>'
    pointer: true
    placement: top
    onnextclick:
      - ':nth-child(3) > :nth-child(3) > :nth-child(1) > .portlet-operations > .ui-button-default'



  - title: '<b>Adapter clipping</b>'
    element: ':nth-child(4) > .portlet-content > .portlet-body > :nth-child(1) > :nth-child(1) > .ui-form-field > :nth-child(1) > :nth-child(2) > .ui-button-default'
    placement: top
    content: 'Analogously, insert Illumina universal 3prime adapter for the second read mate.'
    onnextclick:
      - ':nth-child(4) > .portlet-content > .portlet-body > :nth-child(1) > :nth-child(1) > .ui-form-field > :nth-child(1) > :nth-child(2) > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r2|adapters2_0|adapter_source2|adapter_source_list2"]'
    placement: top
    content: '<text style="color:red">Select: <b>Enter custom sequence</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r2|adapters2_0|adapter_source2|adapter2"]:first'
    placement: top
    content: '<text style="color:red">Enter: <b>AGATCGGAAGAGC</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>' 
    element: ':nth-child(4) > :nth-child(2) > :nth-child(1) > :nth-child(1) > :nth-child(1) > :nth-child(3) > :nth-child(1) > :nth-child(2) > .ui-button-default'
    placement: top
    content: 'Add a second adapter.<br />In RRBS-Seq data, a methylation bias is introduced due to an end-repair step in the library preparation necessary because of an unpaired overhang at the MspI-(CCGG)-cutting-site. If a read has adapter content, the CpG/TpG island should be clipped as well. Therefore, we use a the previously entered adapter sequence prefixed by the IUPAC code YG.'
    onnextclick:
      - ':nth-child(4) > :nth-child(2) > :nth-child(1) > :nth-child(1) > :nth-child(1) > :nth-child(3) > :nth-child(1) > :nth-child(2) > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r2|adapters2_1|adapter_source2|adapter_source_list2"]'
    placement: top
    content: '<text style="color:red">Select: <b>Enter custom sequence</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r2|adapters2_1|adapter_source2|adapter2"]:first'
    placement: top
    content: '<text style="color:red">Enter: <b>YGAGATCGGAAGAGC</b></text>'
    pointer: true
    placement: top
    onnextclick:
      - ':nth-child(4) > :nth-child(1) > .portlet-operations > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: ':nth-child(5) > .portlet-header > .portlet-operations > .ui-button-default'
    placement: left
    content: 'Expand adapter options'
    onnextclick:
      - ':nth-child(5) > .portlet-header > .portlet-operations > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="adapter_options|overlap"]'
    content: 'The <b>Minimum overlap length</b> of the adapter sequence required to trim a sequence, indicates how many bp are required for the adapter to overlap with the sequence read to remove the sequence from the dataset.<br />The default value is too stringent, and on average will result in removing 25% of the reads.<br /><text style="color:red">Enter: <b>5</b></text><br />'
    placement: top
    pointer: true
    onnextclick:
      - ':nth-child(5) > .portlet-header > .portlet-operations > .ui-button-default'


  - title: '<b>Adapter clipping</b>'
    element: '#execute'
    placement: top
    postclick:
      - '#execute'
    content: 'With the current parametrisation, Cutadapt will clip the adapter sequences<br />
For all remaining parametrisation options, we will use the provided default settings. However, for further information, please refer to the manual provided below the tool box.<br />'

  - title: '<b>Adapter clipping</b>'
    element: '#right'
    content: 'Cutadapt processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br />'
    placement: left
    onloadwait:
      - element: '#current-history-panel > .list-items > :nth-child(1) > .title-bar > .title > span:contains("Cutadapt")'



# again for treatment




  - title: '<b>Adapter clipping</b>'
    element: '#tool-search-query'
    content: 'Meanwhile, analogously perform adapter clipping on treated dataset collections using <b>Cutadapt</b> tool.<br />'
    placement: bottom
    textinsert: cutadapt
    postclick:
      - >-
        a[href$="/tool_runner?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Flparsons%2Fcutadapt%2Fcutadapt%2F1.16.6"]


  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="library|type"]'
    content: '<text style="color:red">Select: <b>Paired-end</b></text>'
    pointer: true
    placement: bottom


  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="library|input_1"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton:last > :nth-child(3)'
    content: 'Select dataset collection.<br /><br />'
    placement: bottom
    onnextclick:
      - 'div[tour_id="library|input_1"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton:last > :nth-child(3)'


  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="library|input_1"]:last'
    content: '<text style="color:red">Select: <b>treat.R1</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="library|input_2"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton:last > :nth-child(3)'
    content: 'Select dataset collection.<br /><br />'
    placement: bottom
    onnextclick:
      - 'div[tour_id="library|input_2"] > .ui-form-field > .ui-select-content > .ui-options > .btn-group.ui-radiobutton:last > :nth-child(3)'

  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="library|input_2"]:last'
    content: '<text style="color:red">Select: <b>treat.R2</b></text>'
    pointer: true
    placement: top





  - title: '<b>Adapter clipping</b>'
    element: ':nth-child(3) > :nth-child(3) > .portlet-content > .portlet-body > :nth-child(1) > :nth-child(1) > .ui-form-field > :nth-child(1) > :nth-child(2) > .ui-button-default'
    placement: top
    content: 'Insert Illumina universal 3prime adapter'
    onnextclick:
      - ':nth-child(3) > :nth-child(3) > .portlet-content > .portlet-body > :nth-child(1) > :nth-child(1) > .ui-form-field > :nth-child(1) > :nth-child(2) > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r1|adapters_0|adapter_source|adapter_source_list"]'
    placement: top
    content: '<text style="color:red">Select: <b>Enter custom sequence</b></text>'
    pointer: true
    placement: top


  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r1|adapters_0|adapter_source|adapter"]:first'
    placement: top
    content: '<text style="color:red">Enter: <b>AGATCGGAAGAGC</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>' 
    element: ':nth-child(3) > :nth-child(3) > :nth-child(2) > :nth-child(1) > :nth-child(1) > :nth-child(1) > :nth-child(3) > :nth-child(1) > :nth-child(2) > .ui-button-default'
    placement: top
    content: 'Add a second adapter.<br />In RRBS-Seq data, a methylation bias is introduced due to an end-repair step in the library preparation necessary because of an unpaired overhang at the MspI-(CCGG)-cutting-site. If a read has adapter content, the CpG/TpG island should be clipped as well. Therefore, we use a the previously entered adapter sequence prefixed by the sequence YG in IUPAC code.'
    onnextclick:
      - ':nth-child(3) > :nth-child(3) > :nth-child(2) > :nth-child(1) > :nth-child(1) > :nth-child(1) > :nth-child(3) > :nth-child(1) > :nth-child(2) > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r1|adapters_1|adapter_source|adapter_source_list"]'
    placement: top
    content: '<text style="color:red">Select: <b>Enter custom sequence</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r1|adapters_1|adapter_source|adapter"]:first'
    placement: top
    content: '<text style="color:red">Enter: <b>YGAGATCGGAAGAGC</b></text>'
    pointer: true
    placement: top
    onnextclick:
      - ':nth-child(3) > :nth-child(3) > :nth-child(1) > .portlet-operations > .ui-button-default'



  - title: '<b>Adapter clipping</b>'
    element: ':nth-child(4) > .portlet-content > .portlet-body > :nth-child(1) > :nth-child(1) > .ui-form-field > :nth-child(1) > :nth-child(2) > .ui-button-default'
    placement: top
    content: 'Analogously, insert Illumina universal 3prime adapter for the second read mate.'
    onnextclick:
      - ':nth-child(4) > .portlet-content > .portlet-body > :nth-child(1) > :nth-child(1) > .ui-form-field > :nth-child(1) > :nth-child(2) > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r2|adapters2_0|adapter_source2|adapter_source_list2"]'
    placement: top
    content: '<text style="color:red">Select: <b>Enter custom sequence</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r2|adapters2_0|adapter_source2|adapter2"]:first'
    placement: top
    content: '<text style="color:red">Enter: <b>AGATCGGAAGAGC</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>' 
    element: ':nth-child(4) > :nth-child(2) > :nth-child(1) > :nth-child(1) > :nth-child(1) > :nth-child(3) > :nth-child(1) > :nth-child(2) > .ui-button-default'
    placement: top
    content: 'Add a second adapter.<br />In RRBS-Seq data, a methylation bias is introduced due to an end-repair step in the library preparation necessary because of an unpaired overhang at the MspI-(CCGG)-cutting-site. If a read has adapter content, the CpG/TpG island should be clipped as well. Therefore, we use a the previously entered adapter sequence prefixed by the IUPAC code YG.'
    onnextclick:
      - ':nth-child(4) > :nth-child(2) > :nth-child(1) > :nth-child(1) > :nth-child(1) > :nth-child(3) > :nth-child(1) > :nth-child(2) > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r2|adapters2_1|adapter_source2|adapter_source_list2"]'
    placement: top
    content: '<text style="color:red">Select: <b>Enter custom sequence</b></text>'
    pointer: true
    placement: top

  - title: '<b>Adapter clipping</b>'
    element: '[tour_id="library|r2|adapters2_1|adapter_source2|adapter2"]:first'
    placement: top
    content: '<text style="color:red">Enter: <b>YGAGATCGGAAGAGC</b></text>'
    pointer: true
    placement: top
    onnextclick:
      - ':nth-child(4) > :nth-child(1) > .portlet-operations > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: ':nth-child(5) > .portlet-header > .portlet-operations > .ui-button-default'
    placement: left
    content: 'Expand adapter options'
    onnextclick:
      - ':nth-child(5) > .portlet-header > .portlet-operations > .ui-button-default'

  - title: '<b>Adapter clipping</b>'
    element: 'div[tour_id="adapter_options|overlap"]'
    content: 'The <b>Minimum overlap length</b> of the adapter sequence required to trim a sequence, indicates how many bp are required for the adapter to overlap with the sequence read to remove the sequence from the dataset.<br />The default value is too stringent, and on average will result in removing 25% of the reads.<br /><text style="color:red">Enter: <b>5</b></text><br />'
    placement: top
    pointer: true
    onnextclick:
      - ':nth-child(5) > .portlet-header > .portlet-operations > .ui-button-default'


  - title: '<b>Adapter clipping</b>'
    element: '#execute'
    placement: top
    postclick:
      - '#execute'
    content: 'With the current parametrisation, Cutadapt will clip the adapter sequences<br />
For all remaining parametrisation options, we will use the provided default settings. However, for further information, please refer to the manual provided below the tool box.<br />'

  - title: '<b>Adapter clipping</b>'
    element: '#right'
    content: 'Cutadapt processing has begun, and the results are loading in your history.<br />
Results are available as soon as their entries turn green.<br />'
    placement: left
    onloadwait:
      - element: '#current-history-panel > .list-items > :nth-child(1) > .title-bar > .title > span:contains("Cutadapt")'



# wait and tag



  - title: '<b>Adapter clipping</b>'
    element: '#masthead'
    content: 'Adapter clipping has been completed.<br />'
    placement: bottom
    onloadwait:
      - element: '#current-history-panel > .list-items > .list-item.dataset-collection.history-content.state-loading'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset-collection.history-content.state-new'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset-collection.history-content.state-running'
        count: 0
      - element: '#current-history-panel > .list-items > .list-item.dataset-collection.history-content.state-queued'
        count: 0

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-items > :nth-child(1) > .title-bar > .title'
    content: 'To keep track of the data being processed, we will use tags (1/4).<br />'
    placement: top
    onnextclick:
      - '#current-history-panel > .list-items > :nth-child(1) > .title-bar > .title'

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-panel > .controls > .tags-display'
    content: '<text style="color:red">Enter and confirm by return keypress: <b>noadapter.treat.R2</b></text>'
    placement: top
    pointer: true

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-panel > .controls > .navigation > .back'
    content: 'Return to history main view'
    placement: bottom
    onnextclick:
      - '#current-history-panel > .list-panel > .controls > .navigation > .back'

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-items > :nth-child(2) > .title-bar > .title'
    content: 'To keep track of the data being processed, we will use tags (2/4).<br />'
    placement: top
    onnextclick:
      - '#current-history-panel > .list-items > :nth-child(2) > .title-bar > .title'

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-panel > .controls > .tags-display'
    content: '<text style="color:red">Enter and confirm by return keypress: <b>noadapter.treat.R1</b></text>'
    placement: top
    pointer: true

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-panel > .controls > .navigation > .back'
    content: 'Return to history main view'
    placement: bottom
    onnextclick:
      - '#current-history-panel > .list-panel > .controls > .navigation > .back'

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-items > :nth-child(3) > .title-bar > .title'
    content: 'To keep track of the data being processed, we will use tags (3/4).<br />'
    placement: top
    onnextclick:
      - '#current-history-panel > .list-items > :nth-child(3) > .title-bar > .title'

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-panel > .controls > .tags-display'
    content: '<text style="color:red">Enter and confirm by return keypress: <b>noadapter.ctr.R2</b></text>'
    placement: top
    pointer: true

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-panel > .controls > .navigation > .back'
    content: 'Return to history main view'
    placement: bottom
    onnextclick:
      - '#current-history-panel > .list-panel > .controls > .navigation > .back'

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-items > :nth-child(4) > .title-bar > .title'
    content: 'To keep track of the data being processed, we will use tags (4/4).<br />'
    placement: top
    onnextclick:
      - '#current-history-panel > .list-items > :nth-child(4) > .title-bar > .title'

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-panel > .controls > .tags-display'
    content: '<text style="color:red">Enter and confirm by return keypress: <b>noadapter.ctr.R1</b></text>'
    placement: top
    pointer: true

  - title: '<b>Adapter clipping</b>'
    element: '#current-history-panel > .list-panel > .controls > .navigation > .back'
    content: 'Return to history main view'
    placement: bottom
    onnextclick:
      - '#current-history-panel > .list-panel > .controls > .navigation > .back'

  - title: '<b>Adapter clipping</b>'
    element: '#masthead'
    content: 'You successfully completed this Galaxy atom<br />'
    placement: bottom
